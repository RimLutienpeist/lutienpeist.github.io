# 无线网络应用

[TOC]



## Chap-1 当今网络

### 1.2   网络组件

#### 1.2.1   主机角色

- 所有**连接到网络并参与网络通信的设备都**称为主机，主机也称为**终端设备**。

- 根据主机在网络中所扮演的角色不同，可分为：**服务器与客户端**。

  主机为了能够相互通信，都设置有一个**数字标识**，称为**互联网协议（IP）地址**。IP地址用于标识主机和主机所连接的网络。

![image-20231210182056094](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231210182056094.png)

**基础架构网络**：由中间设备（交换机、路由器、接入点）将终端设备（服务器、客户端）互连而成的网络。

#### 1.2.2   点对点（对等网络）

多台PC直接互连，没有中间设备。

对等网络中的许多计算机既是服务器又是客户端。

![image-20231210182248675](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231210182248675.png)

#### 1.2.3   终端设备

终端设备是通过网络传输消息的**源或目的地**。为了区分不同的终端设备，网络中的每台终端设备都用地址加以标识。当一台终端设备发起通信时，**会使用目的终端设备的地址来指定**应该将消息发送到哪里。

![image-20231210182505867](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231210182505867.png)

#### 1.2.4   中间设备（网络设备）

中间设备将每台终端设备连接到网络，并且可以将多个独立的网络连接成网际网络。

![image-20231210182457082](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231210182457082.png)

#### 1.2.5   网络介质

网络介质为数据传输提供物理通道。常用的介质有三种：

- **电缆**：使用金属质材，数据将编码为电脉冲。
- **光纤**：使用玻璃或塑料质材，数据将编码为光脉冲。
- **无线**：使用电磁波传输数据。

![image-20231210182827580](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231210182827580.png)

### 1.3   网络表示方式和网络拓扑

#### 1.3.1   网卡、端口与接口

- **网络接口卡NIC**：终端设备上的网卡，用于提供设备与网络之间的连接。
- **端口**：网络设备上的插口，网络介质通过它连接到终端设备或其它网络设备。
- **接口**：网络设备上连接到独立网络的专用端口。路由器用于互连不同的网络，路由器上的端口称为网络接口。

#### 1.3.2   拓扑图

网络拓扑图是提供直观网络连接的结构图。

-  物理拓扑图： 标识**设备**和**电缆**安装的物理位置。

  - 物理拓扑图记录各台**主机的位置**及其与**网络连接的方式**。

  - 物理拓扑图还会显示**电缆的安装位置**、**网络设备位置**等。

    ![image-20231211095212555](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211095212555.png)

-  逻辑拓扑图： 标识设备、端口和编址方案。
  - 逻辑拓扑图**对主机进行分组的依据是它们使用网络的方式**，而**不考虑它们的物理位置**。主机名称、IP地址、组信息和应用程序都可以记录在逻辑拓扑图中。

![image-20231211095302226](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211095302226.png)

### 1.4   常见网络类型

#### 1.4.1   多种规模的网络

1. **小型家庭网络**：连接少量的几台计算机（个位数），可以实现共享文件、共享打印机等基本网络功能，并将它们连接到互联网。
2. **小型办公室/家庭办公室网络（SOHO）**：可以让一个小型/家庭办公室内的计算机连接到企业网络或公共网络。
3. **大中型网络**（大型企业和学校使用的网络）：可能有许多站点，包含成百上千台相互连接的计算机。
4. **Internet**：全球所有网络组成的全体集合，连接全球亿万台计算机。Internet是现存最大的网络。术语“Internet”是指“众多网络所组成的网络”。

#### 1.4.2   LAN和WAN

- 局域网（LAN）：网络覆盖区域较小，通常是由个人或单个部门拥有并管理的家庭或小型网络。
- 广域网（WAN）：网络覆盖范围广阔，通常由通信服务提供商（ISP）拥有并管理。

![image-20231211095500589](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211095500589.png)

#### 1.4.3   互联网

​    Internet是互连网络的全球集合。多个LAN通过WAN互连，然后WAN再彼此互连下去……
​	Internet不属于任何个人或团体。为了确保Internet有效可靠地通信，需要采用统一的技术和标准，也需要众多的网络管理机构相互协作。为了维护互联网协议的标准化，人们建立了许多组织，其中包括： ICANN、 IETF、IEEE等。

#### 1.4.4   内部网和外联网

- **内部网**（Intranet）– 通常用于表示一个组织的私有局域网和广域网连接，只有该组织的成员、员工或其他获得授权的人员可以访问。
- **外联网**（Extranet）– 组织可以使用外联网为需要本组织数据的外部用户提供安全访问。例如公司为外部供应商和承包商提供访问。

![image-20231211100042113](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211100042113.png)

### 1.6   可靠网络

#### 1.6.1   网络架构

网络的底层架构必须具备以下四个基本特性才能满足用户的期望：

![image-20231211102914864](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211102914864.png)

#### 1.6.2   容错能力

人们期望Internet能始终为用户提供服务。容错网络应能够降低故障影响，使受故障影响的设备数量降至最低，并在发生故障时能够快速恢复。

有多条路径可以到达目的地被称为冗余。如果一条路径失败，消息可以通过其它备份路径发送。

#### 1.6.3   可扩展性

可扩展的网络能迅速扩张以支持新增用户和应用程序，同时还应该保证不会影响到为现有用户。

网络软硬件的设计开发人员遵循统一的技术标准，使得网络易于扩展。

#### 1.6.4   服务质量（QoS）

QoS是用于管理拥塞和确保可靠传输数据的一种机制。

QoS策略会对不同类型的数据**配置不同级别的传输优先级。**

例如，一位用户正在请求网页，另一位用户在拨打IP电话。部署了QoS策略的路由器将会优先处理语音通信。

#### 1.6.5   安全性

**网络基础设施**以及联网设备上的**数据**是极为重要的资产。

两种网络安全问题：**网络基础设施安全性**和**信息安全性**。一方面要**保护网络设备的安全**，另一方面要防止有人**未经授权地**访问网络设备上的管理软件。

信息安全是指保护网络中**传输的信息**和网络设备中**存储的信息**。

- 机密性 - 数据机密性或保密性意味着**只有预定和授权收件人**可访问并读取数据。
- 完整性 - 数据完整性表示保证信息在从源地址到目的地址的**传输过程中，不会被更改**（篡改）。
- 可用性 - 数据可用性表示授权用户能**及时可靠地访问数据**。

![image-20231211103400122](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211103400122.png)



## Chap-2   网络协议和通信

### 2.1   通信规则

通信的三个基本要素

- 消息来源：发送方，向其他人或设备发送消息。
- 消息目的：接收方，接收并解释消息。
- 通道：消息从源地址传送到目的地址的路径，由介质构成。

#### 2.1.3   通信协议（Protocols）

消息的发送和接收都需要按照一定的规则（协议）来进行。

不同类型的通信方式，会有不同的协议。例如电话通信和信件通信有各自不同的通信规则。

#### 2.1.4   规则建立（人际沟通）

成功的人际沟通所应遵守的规则包括：

1. 发送方和接收方的名字或标识（ID）
2. 通用的语言和语法
3. 传递消息的速度和时间
4. 证实或确认要求

#### 2.1.5   网络协议要求

计算机网络通信需遵守一定的规则或协议。这些通信协议由消息的源、目的和通道的特性决定。例如：不同的传输介质会采用不同的协议。

通信协议定义了传输消息的详细方式，包括五个方面：

1. 消息编码
2. 消息格式及封装
3. 消息大小（长短）
4. 消息时序
5. 消息模式（传输选项）

![image-20231211104341795](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211104341795.png)

#### 2.1.6   消息编码

消息先转换成**比特位**，然后根据传输介质，将每一位编码成电子脉冲、光信号或电磁波。目的主机接收并解码信号，解释收到的消息。

#### 2.1.7   消息格式和封装

- 将一种**消息格式（信件）**放入另一种**消息格式（信封）**的过程称为**封装**。
  - 收信人从信封中取出信件的过程称为**解封装**。

- 就像信件封装在信封中进行投递一样，计算机消息也要进行封装以便于传输和处理。
  - 每一条计算机消息，先形成**数据包（Packet）**，然后再封装在**数据帧（Frame）**中，并通过网络发送。
  - **帧**就像信封一样，它提供**“目的和源”的地址**等信息。
  - **数据帧**中的地址称为**物理地址（MAC地址）**；**数据包**中也含有**“目的和源”的地址**，称为**逻辑地址（IP地址）**。



![image-20231211105157375](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211105157375.png)

![image-20231211105147475](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211105147475.png)

#### 2.1.8   消息大小（长短）

- 发送主机**将长消息分割为多个片段或帧**。**帧太长或太短都无法传送**。以太网中，帧的长度需满足：64~1518字节。
- 每个帧都有自己的**编址信息（片段序号）**。
- 在接收主机上，消息的各个片段会**依据其编址信息重新组合拼装**为原始消息。

#### 2.1.9   消息时序（时间顺序）

- 访问方法 - 决定了**可以发送消息的时间**。如果两个人同时讲话，就会发生冲突，必须重新开始。在计算机通信中，也必须定义访问方法。
- 流量控制 - 决定了发送信息的速度。如果一个人讲话太快，对方就难以听清和理解。在计算机通信中，源主机需使用流量控制来确定**发送消息的量和速度**。
- 响应超时 – 如果一个人提问之后，在合理的时间内未得到应答，此人可能会重复这个问题，也可能忽略此问题并继续交谈。计算机通信中的源主机也会使用规则来指定等待响应的时长，以及在响应超时的情况下执行何种操作。

#### 2.1.10   消息传输方式

- 单播（一对一），消息只有一个目的地址。
- 组播（一对多），将同一条消息同时发送到一组目的主机。
- 广播（一对全体），本地网络上的所有主机都需要同时接收该消息。

### 2.2   协议

#### *2.2.1  网络协议概述

Internet能够正常运作，它要求：所有设备都必须**遵循一套相同的规则**。**这些规则被称为协议**，每一种协议有各自特定的功能。

![image-20231211105729228](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211105729228.png)

#### *2.2.2   网络协议的功能

网络通信协议**定义了**在终端设备之间进行通信时**所需的各种功能**。这些功能包括：

![image-20231211105743742](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211105743742.png)

#### 2.2.3   协议交互

计算机通过网络发送消息时，需要**使用多种协议**，每种协议都有各自特定的功能和格式。

### 2.3   协议簇

#### 2.3.1   网络协议簇

实现某种通信功能所需的**一组相关协议**称为**协议簇/族/栈**。

**协议簇为分层结构**，**每一个上层协议都依赖于其下层协议所提供的功能**。下层协议负责**传输数据**，而上层协议则负责**处理消息**。

以两个人的交互为例：

- 底层是**物理层**，两个人约定通过电话交流。
- 中间层是**规则层**，两个人约定使用通用的语言交谈。
- 顶层是**内容层**，处理交流内容。

![image-20231211110036870](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211110036870.png)

#### 2.3.3   TCP/IP协议示例 & 3.3.4   TCP/IP协议簇

TCP/IP协议位于应用层、传输层和互联网层。

网络接入层中没有TCP/IP协议，最常见的是以太网协议和WLAN协议。网络接入层协议负责通过物理介质传输 IP 数据包。

![image-20231211110146133](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211110146133.png)![image-20231211110244473](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211110244473.png)

### 2.4   标准组织

#### *2.4.1/2.4.2   开放标准/互联网标准

标准组织是中立于厂商的非营利性组织。这些组织对管理互联网的资源分配、推动互联网的技术升级起着重要作用。

#### 2.4.3   电子和通信标准组织

- 电气电子工程师协会（IEEE）：一个工程师组织，致力于推动诸多行业领域的技术创新和标准创建，涉及的领域非常广泛，包括：电力能源、医疗保健、电信和网络等。
  （IEEE 802.3 以太网，IEEE 802.11  WLAN）
- 美国电子工业协会（EIA）：设计制定用于安装网络设备的线缆、连接器等方面的标准。网线制作实验！
- 电信工业协会（TIA）：负责开发各种领域的通信标准，包括无线电设备、手机信号塔、IP语音（VoIP）设备和卫星通信等。

### 2.5   参考模型

#### 2.5.1   使用分层模型的优点

使用分层模型来描述网络协议及其工作方式，有以下优点：

- 方便了协议设计，因为对特定层级的协议而言，它们的功能以及与上、下层级之间的接口都已确定。
  促进竞争，可以使用不同厂商的产品。
- 避免一个协议层级的技术升级或功能变化影响其它层级。
- 提供了一种描述网络功能的通用语言。

目前使用的两种网络分层模型：TCP/IP模型和OSI模型（开放式系统互联模型）。

OSI模型是网络工作原理的表示方式（理论模型），并非网络的实际构架。

![image-20231211110923626](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211110923626.png)

#### 2.5.2   OSI参考模型

提及OSI模型时，则通常使用其编号。例如，第1层指OSI模型的物理层。

- 应用层：与**应用程序**相关联的各种通信协议。
- 表示层：将需要传输的信息**表示成规范的格式**。
- 会话层：**建立和维持会话**。
- 传输层：**添加端口号，封装数据段；规定数据的传输、重组方式、是否需要确认机制等**。
- 网络层：**添加IP地址，封装数据包；选择发送数据包的路径**。
- 数据链路层：**添加MAC地址，封装数据帧**。
- 物理层：与**传输介质**相关，将数据转换成可以在各种介质上传输的**物理信号**。

![image-20231211111349974](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211111349974.png)

#### 2.5.3   TCP/IP 协议模型

因为Internet的构建遵循此模型的结构，又称为**Internet模型**。它定义了成功通信所需要的四个层级的功能。

当我们提及TCP/IP模型的各层时，通常使用其名称；而提及OSI模型时，则通常使用其编号。例如，第1层指OSI模型的物理层。

![image-20231211111505330](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211111505330.png)



#### 









### 2.6   数据封装

#### 2.6.1   消息分段

将数据流划分为较小的片段称为分段。消息分段的两个优点：

- 可以在网络上交替发送多个不同会话，称为**多路复用**。
- 可以增强网络的**通信效率**。如果由于网络故障或网络拥塞，**有部分消息未能传送到目的地**，则**只需重新传输丢失的部分**。

#### 2.6.2   排序

TCP协议负责对数据段进行排序，即对每个数据段进行编号。

#### 2.6.3   协议数据单元

在传输数据的过程中，随着数据沿协议栈向下传递，**每一层都要添加各种协议信息**。此过程称为封装。

**数据在任一协议层的表示形式**称为协议数据单元（PDU）。在封装过程中，每一层都从上一层接收PDU，并根据当前层协议添加新的封装。

在封装过程的每个阶段，PDU都有各自不同的名称。

![image-20231211111802410](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211111802410.png)

#### 2.6.4   封装示例 & 3.6.5   解封示例

![image-20231211111818799](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211111818799.png)

封装过程越加越大，越加越长。添加的目的：为便于准确传输。

在解封过程中，接收设备删除一个又一个的协议报头。越减越小，越减越短。删减的目的：为提取真正有用的数据。

### 2.7   数据访问

#### 2.7.2  第3层逻辑地址

IP地址用于将数据包从源设备传输到目的设备。**数据包含有两个IP地址：源IP地址和目的IP地址**。

数据在跨网络传输时，数据包的内容不变，即**源主机和目的主机的IP地址不变**。但是数据帧在**经过路由器**时，会**被拆封装和重新封装**，**源和目的的MAC地址会不断变化**。

![image-20231211113219989](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211113219989.png)

#### 2.7.8   数据链路层地址

数据链路层的MAC地址仅用于在本地网络中传输数据。

当数据包从发送主机到接收主机进行传输时，沿途中的每个路由器都会将数据包重新封装到新的数据帧中，每一个新的数据帧都包含新的源MAC地址和新的目的MAC地址。

![image-20231211113424128](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211113424128.png)

![image-20231211113527480](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211113527480.png)

![image-20231211113531771](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211113531771.png)



## Chap-3   以太网（Ethernet）

### 3.3   本地有线网络中的通信

#### 3.3.1  本地有线网络中的协议

本地有线网络中最常用的协议是**以太网（Ethernet）**。

以太网协议定义了本地网络通信的许多方面，包括：消息格式、消息大小、时序、编码和消息模式。

#### ! 3.3.3   物理寻址（重要概念！）

以太网中的主机都会有一个自己的物理地址，用于在网络中标识自己，相当于它的名字。

每个以太网络接口（如PC机的网卡接口）**在制造时，都分配有一个物理地址**。此地址称为**介质访问控制（MAC）地址**。该地址为48位2进制数，6个字节（8位），12个Hex数字。

#### 3.3.5  以太网络的层次设计

MAC地址表示某一主机的**独特身份**，而**不指明主机在网络中的位置**。

- 如果Internet中所有主机（超过4亿台）都只用其唯一的MAC地址来标识，那么要查找一台确定的主机无异于大海捞针！
- 为帮助主机通信，以太网技术还会生成大量的广播流量。广播将发送到一个网络中所有主机，它非常消耗带宽，会减慢网络速度。试想如果连接Internet的所有主机都在一个以太网络中，且都使用广播，结果将会怎样？

由于上述两个原因，由大量主机组成的大型以太网络通常效率极低。所以最好将大型网络分割成便于管理的多个小型网段，这时可使用**层次设计模型**。

在网络中，所谓“层次设计”是指：**将各台设备分组到多个“以分层方式构建”的较小的网络中。**

层次式设计有三个**基本层**：

- 接入层 - 连接本地以太网络中的主机
- 分布层 - 将较小的本地网络相互连接起来
- 核心层 – 在分布层设备之间高速转发大量数据

在这种层次式设计中，需要使用逻辑寻址（IP地址）来标识主机位置。

![image-20231211115042665](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211115042665.png)

#### ! 3.3.6  逻辑寻址（重要概念！）

IP地址（v4）包含两部分：32位，4个十进制数字

- 前面的第一部分标识**本地网络**：所有连接到同一本地网络的主机，其IP地址的网络部分都是一样的；
- 后面的第二部分标识**特定主机**：在同一个本地网络中，IP地址的主机部分是每台主机所独有的。

![image-20231211115302616](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211115302616.png)

IP地址可以用于确定：网络通信流量**应保留在本地，还是上移到网络的更高层去进行中转**。

- 若目的IP和源IP的网络部分相同，即二者属于同一网络，则保留在本地不出去。这时，源主机将消息通过交换机直接发送到目的主机。（发送任务由交换机独立完成）
- 若目的IP和源IP的网络部分不同，即二者属于不同网络，则需要上移到更高的层级去中转。这时，源主机将消息通过交换机发送到路由器端口（默认网关），由路由器寻找路径，将消息发送到目的主机。（发送任务由交换机转交给路由器完成）

**MAX & IP**

- 主机的MAC地址一般不会改变，它是制造厂商固化在网卡内的地址，称为物理地址。无论主机在网络中哪个位置，其物理地址都保持不变，类似于人的名字。
- IP地址类似于人的住址或通信地址，称为逻辑地址。IP地址由网络管理员根据本地网络情况手工或自动分配给每台主机，通常并非固定不变的。



- 层次网络中的主机，同时需要MAC地址和IP地址；就如同在寄信时，同时需要收信人的名字和通信地址一样。
  - IP地址在数据包的包头中
  - MAC地址在数据帧的帧头中

#### 3.3.7   接入层、分布层和设备

**接入层**为**终端用户设备连接到网络提供连接点**，允许多台主机通过网络设备（通常是**交换机**）相互连接。

**分布层**为**各本地网络提供连接点**，并且控制信息在网络之间的流动。它使用的设备通常为**路由器**。路由器具有路由功能，负责查找从源主机发送消息到目的主机的最佳路径。

**核心层**是包含冗余连接的**高速中枢层**。它负责在**多个终端网络之间传输大量的数据**。它包含**非常强大的高速交换机和路由器**。其主要功能是：快速传输大量数据。



### 3.4   创建以太网络的接入层

#### 3.4.1  接入层

**接入层是网络的最基本层级**，它为用户提供连接点，用于：访问其它主机、共享文件或打印机。接入层包含主机设备与其它相关的网络设备。

接入层中的每台主机使用线缆连接到网络设备，如交换机。

![image-20231211115845623](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211115845623.png)

#### ! 3.4.3   交换机的功能（重要概念！）

交换机Switch是接入层的一种多端口设备。

交换机可**将多台主机连接到网络**。交换机**可转发消息到特定主机**。

交换机上的**MAC地址表**列出了所有活动端口以及所有与这些活动端口相连主机的MAC地址。

当一台主机发送消息到另一台主机时，交换机将**接受并解码消息帧**，以**读取目的主机的MAC地址**，然后**在MAC地址表中找到相应端口并作出转发**。

![image-20231211120149640](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211120149640.png)

当主机之间发送消息时，交换机将**检查目的主机的MAC地址是否在MAC地址表**中。

- 如果在，交换机就会在源端口与目的端口之间**创建一个临时的专用通道**，其它主机不会使用此通道。主机间的**每次通信都会创建一条新的独立通道**，这些专用通道使交换机上可同时进行多个通信，而**不会发生冲突使数据损坏**。
- 如果不在，交换机会采用“泛洪”处理方式，查询目的主机的MAC地址，并**更新自己的MAC地址表**。

#### 3.4.4   广播消息

在本地网络中，某台主机需要**将消息同时发送到所有其它主机**可以通过“广播”消息来实现。

当某台主机需要查找信息，但又不确定“哪台主机”可以提供信息时，可使用广播消息。

发送广播消息时需要使用一个特殊的MAC地址——**广播MAC地址**，它是一个**全部由1组成的48位地址**。鉴于其长度，MAC地址通常用十六进制表示。十六进制的广播MAC地址为**FFFF.FFFF.FFFF**，其中每个F代表二进制中的四个1（即十进制中的15）。

当某台主机发出一条广播消息时，交换机会将该消息转发到**同一本地网络**连接的每台主机。故本地网络也称为广播域。**广播域**：当任一主机发送广播消息时，所有能够接受该广播消息的主机的集合（或者网络区域）。

![image-20231211120700511](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211120700511.png)

#### 3.4.6   地址解析协议（ARP）

在本地网络通信中，需要两种地址：MAC地址和IP地址。但很多场合下，**源主机只知道目的主机的IP地址**，故需要一种机制用于：**根据IP地址查询MAC地址**，这种机制称为地址解析协议（ARP）。ARP：IP->MAC

关于网络主机中的ARP表：（arp -a）

- ARP表保存了本地网络中所有主机的IP地址与MAC地址（还包括广播地址、默认网关地址等）
- ARP表的作用：帮助发送主机形成数据帧
- ARP表是动态更新的（通过ARP广播）



### 3.5   创建网络的分布层

#### 3.5.1   分布层 & 路由器

随着网络的扩大，应将一个本地网络分成多个接入层网络，然后用分布层设备（如路由器）进行互联。

![image-20231211120938731](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211120938731.png)

**路由器的特点**

路由器在本质上是一台计算机。和计算机、平板电脑或其它智能设备一样，路由器由以下部分组成：

- 中央处理器（CPU）
- 操作系统（OS）：Cisco Internetwork Operating System（IOS）用于各种思科设备的系统软件。
- 内存：
  随机访问存储器（RAM）
  只读存储器（ROM）
  非易失性随机访问存储器（NVRAM）

**路由器的外观**

思科设备使用LED指示灯来提供状态信息。如果接口为活动状态而且连接正确，但LED不亮，则表示该接口可能存在故障。如果接口极其繁忙，则其LED 会一直亮起或持续快速闪烁。

![image-20231211121051769](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211121051769.png)

**LAN和WAN接口**

路由器接口可分为两类：

- 以太网LAN接口 - 用于连接LAN设备（如计算机或交换机）。此接口也可用于路由器之间的相互连接。
- 串行WAN接口 - 将路由器连接到远程网络（地理位置较远）。

![image-20231211121533805](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211121533805.png)



#### 3.5.2  路由器的功能（重要概念！）

路由器Router是一种用于**连接不同本地网络的分布层设备**。路由器每个端口都连接到一个本地网络。

路由器与交换机一样，都可以读取收到的消息。交换机读取的是数据帧帧头中的MAC地址，路由器读取的是**数据帧中封装的数据包包头中的IP地址**。

数据包包头中包含目的主机和源主机的IP地址以及消息数据。路由器读取**目的主机IP地址的网络部分，查找转发到目的主机的最佳路径/最佳路由**。

路由器利用**路由表**确定发送消息到目的网络时采用的路径。每个路由器都包含一个**路由表**，里面有多条**路由信息**，每条**路由**列出了：

1. 接口
2. 通过该接口能到达的目的网络
3. 这条路由的优劣信息（路由权值/度量指标/Metric）。

路由器使用这些信息来指导数据到达目的网络。

#### 3.5.3   默认网关（网关 Gateway =出口）

必须**在本地网络的每台主机上**配置正确的默认网关。如果没有在主机TCP/IP设置中配置默认网关，或者指定了错误的默认网关，便**无法将消息发送到远程网络上的主机**。

默认网关**是本地网络的出口**，要到其它外界网络去，必须先到默认网关然后再转出去。

默认网关地址就是主机所在的本地网络所连接的**路由器接口的IP地址**。

![image-20231211122106649](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211122106649.png)

### **简单总结**

1. 交换机：连接终端设备构成本地网络，负责本地网络通信，读取数据帧的MAC地址。
2. 路由器：连接本地网络，负责跨网络通信，读取数据包的IP地址。
3. 终端设备网卡：形成数据帧。
   1. ARP表中包含有本地网络中其它主机的“IP地址与MAC地址对”信息。其内容可通过 arp –a 命令查看。
   2. ARP表是实时更新的，如果某台主机的信息不在其中，则会发起ARP地址解析协议进行查询。
4. 本地网络通信：发送主机根据ARP表中的信息，直接形成数据帧。
5. 远程网络通信：发送主机将默认网关的MAC地址封装于数据帧的帧头，将目的主机的IP地址封装于数据包的报头。

[数据帧转发过程中IP地址及MAC地址的变化 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/515239767)



## Chap-4   通过ISP连接到Internet

### 4.2   连通性测试命令

#### ! 4.2.3  在Internet中转发数据包（重要）

- ping命令可用于测试源设备与目的设备之间的连通性。（Ctrl+C中止）
- traceroute实用程序可追踪源设备与目的设备之间的路由。
  - tracert命令…（Ctrl+C中止）
  - 数据包在传输过程中**每经过一个路由器称为一跳**（跃点，Hop）。traceroute显示沿途的每一跳，以及到每一跳所花费的时间。
  - 如果发生问题，便可利用所显示的时间以及数据包经过的路由来判断数据包是在何处丢失或延迟的。

### 4.4  线缆和连接器

#### 4.4.1   常见的网络线缆

- 要进行通信，必须存在源、目的以及某种类型的通道（或介质）。
  - 介质通常是某种**物理线缆**，也可以是**电磁波**。
  - 源与目的之间的连接可以是直接的，也可以是间接的，甚至可能跨越多种介质类型。

- 物理线缆分为两类：
  - **金属电缆**一般为铜或铝，使用电子脉冲传输信息。
  - **光纤**由玻璃或塑料制成，使用光脉冲来传输信息。

- 双绞线（Twisted Pair，TP）：以太网通常使用双绞线（一种铜质电缆）来连接设备。由于以太网是大多数局域网的基础，因此双绞线是最常见的网络布线类型。
- 同轴电缆：同轴电缆由铜或铝制成，有线电视使用这种电缆，也可用于卫星通讯系统。
- 光纤：由玻璃或塑料制成。其带宽很高，可承载大量的数据。光纤用于主干网络、大型企业环境以及大型数据中心。

![image-20231211130225224](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211130225224.png)

#### 4.4.2   双绞线电缆

双绞线电缆由一对或多对绝缘铜线构成，其中每一对以塑料材质绝缘的铜线相互扭（绞绕）在一起，这即是双绞线名称的由来，最外面包裹着一层橡胶的防护套（总外皮）。与所有铜质电缆类似，双绞线使用电子脉冲来传输数据。

![image-20231211130935781](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211130935781.png)

数据传输对干扰噪声很敏感，干扰或噪声会导致线缆的数据速率下降。

双绞线电缆容易受到电磁干扰的影响（电磁干扰简称EMI，属于一种噪声）。若多根电缆在很长一段距离中被捆扎在一起，还会发生另一种干扰——**串扰**。串扰是指信号从一根电缆泄漏出去，串入附近的其它根电缆中对其造成干扰。若数据传输受到串扰之类干扰的破坏，则必须重新传输数据，这会降低介质的数据传送能力/效率。

在双绞线布线中，电缆单位长度的绞合次数决定了其抗干扰能力。

针对干扰情况不同的场合，可采用三种类型的双绞线电缆：**非屏蔽双绞线UTP、屏蔽双绞线STP和外屏蔽双绞线ScTP**。

- 屏蔽：外层包裹有**金属编织物箔层**，可以更好抵抗外界电磁干扰EMI和无线电射频干扰RFI.
  - 非屏蔽双绞线（UTP）是北美和其它许多地区（包括中国）最常用的网络电缆类型.
  - 屏蔽双绞线STP及外屏蔽双绞线ScTP（和F-UTP）在欧洲国家应用最为广泛。

- **UTP电缆**：成本低、带宽较高、安装容易。此类电缆用于连接工作站、主机和网络设备。此类电缆的表皮内包含的线对数量通常为4对。每一线对都由特定的颜色代码标识。

![image-20231211131305182](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211131305182.png)

- STP及ScTP电缆：在某些EMI和RFI非常强的电子环境中，或在某些要求极高的场合（如核电、军事部门），需要使用具有屏蔽功能的电缆如STP或ScTP电缆，这两种电缆都非常昂贵，灵活度不高，并具有一些由屏蔽而带来的额外要求，使用起来相当不便。

![image-20231211131329196](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211131329196.png)



所有种类的数据级UTP电缆一般都用**RJ-45水晶头**作为端头。其材质为聚氯乙烯PVC透明塑料。RJ45型网络插头俗称水晶头，有8槽8金属簧片。屏蔽水晶头外包有金属屏蔽层。

![image-20231211131607239](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211131607239.png)



### 4.5  使用双绞线布线

#### 4.5.1   布线标准

进行布线时，必须遵循**布线标准**。

布线标准是用于安装和测试电缆的一组规范。布线标准规定了在特定环境中使用的电缆类型、材料、引线、电线尺寸、屏蔽方式、电缆长度、连接器类型以及性能限制。

许多组织都参与了布线标准的制定。其中一些组织仅具有本地管辖权，另外还有一些组织（EIA/TIA）提供的标准在全世界范围内被广泛采用。

#### ! 4.5.2   UTP电缆（重要概念！）

TIA/EIA组织定义了两种不同模式的**末端线序（布线方式）**，分别称为**T568A和T568B。**

制作网线时，必须在两种模式（T568A或T568B）中选择一种。在电缆内部X白跟X成对绞合在一起！X=绿/橙/蓝/棕

![image-20231211131905038](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211131905038.png)

使用T568A和T568B布线标准可创建两种类型的电缆：**直通电缆**和**交叉电缆**。这两种电缆都可用于数据布线。

- 直通电缆是最常见的电缆类型：电缆两端的末端线序相同。
- 交叉电缆会同时使用两种布线模式：电缆两端的末端线序不同。

连接两个设备所需的电缆类型取决于：**设备用于发送和接收数据的线对。**

- 两个直接连接、并且使用**不同的引脚**来进行发送和接收数据的设备称为**不相似设备**。不相似设备需要使用**直通电缆**来交换数据。
  - 例如发送设备使用1、2引脚发送，接收设备使用1、2引脚接受，这两者为不相似设备，显然用直通电缆。发送引脚对接接受引脚。
- 两个直接连接、并且使用**相同引脚**来进行发送和接收数据的设备称为**相似设备**。相似设备需要使用**交叉电缆**来交换数据。

## Chap-5   网络寻址

### 5.1   IP地址和子网掩码

#### 5.1.1   IP地址的用途

- IP地址是用于**标识特定主机的逻辑地址**。为了与其它设备进行通信，它必须唯一、不能冲突。
- IP地址将分配给主机上的**网络接口卡（网卡）**。具有网络接口卡的设备包括工作站、服务器、网络打印机和IP电话等。某些服务器可拥有多块网卡，每块网卡都有各自的IP地址。**网络设备（如路由器）的接口也需要IP地址**。
- 通过Internet发送的每个数据包都有源IP地址和目的IP地址。

#### 5.1.2   IP地址的结构

- IP地址是32位二进制的数字串。通常以8位为1组**，将32位划分为4组八位字节**，并将每组八位字节用十进制表示。这种记法称为**点分十进制记法**。例如192.168.1.5、10.10.10.34等。

#### 5.1.3   IP地址的组成部分

- 32位的IP地址具有层次性，它由两部分组成。**第一部分用于标识网络**，**第二部分用于标识特定主机**。这两部分在IP地址中都缺一不可。
  - 以IP地址192.168.18.7为例，前三个字节192.168.18为IP地址的网络部分，最后一个字节7为IP地址的主机部分。
  - 这种格式称为**分层寻址**：网络部分表明了主机位于哪个本地网络中。

注意：MAC地址是无层次寻址系统（如人名），IP地址是分层寻址系统（如通信地址）。

#### 5.1.4   IP地址和子网掩码的交互方式

在配置主机地址时，要随IP地址设置子网掩码。子网掩码的长度也是32位，也采用点分十进制记法。

- 子网掩码用于表明：IP地址中的**哪些部分代表网络，哪些部分代表主机**。
- 子网掩码中**“1”**的部分对应于IP地址中的**网络部分**（有时还包括所谓的“子网”部分）
- 子网掩码中**“0”**的部分对应于IP地址中的**主机部分**

子网掩码是IP地址的重要组成部分，一个不带子网掩码的IP地址没有意义。

最常见的子网掩码是（N=Network，H=Host）：

- 255.0.0.0（N.H.H.H）
- 255.255.0.0（1N.N.H.H）
- 255.255.255.0（N.N.N.H）

**前缀长度**

- 前缀长度是一种识别子网掩码的速记方法。
- 前缀长度 = 子网掩码中设置为 1 的位数。
- 使用“斜线记法”表示，即“/”紧跟为 1 的位数。
      例如：192.168.1.5 / 24

![image-20231211145022071](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211145022071.png)

- 计算某一子网掩码对应的网络中**可容纳的主机数量**

  - 以2为底、以**主机部分**的位数为指数求幂（如$2^8$=256）。
  - 必须再从结果数字中减2（如256-2），原因在于：
    - 主机部分为全1的IP地址是**广播地址**，不能分配给主机；
    - 主机部分为全0的IP地址是**网络地址**，也不能分配给主机。

  - EXP// 192.168.1.100（子网掩码255.255.255.0）所属网络的

    - 广播地址是192.168.1.255（主机部分全1），

    - 网络地址是192.168.1.0（主机部分全0）。

- 计算网络地址：将主机的IP地址与子网掩码表示成二进制数再逐位进行**逻辑与运算**，可得该主机所属的网络地址

- 当主机发送数据包时，**源主机**会用**子网掩码**与自身IP地址以及目的IP地址作比较。
  - 如果两个IP地址的网络部分相同，则表示源主机和目的主机位于同一个本地网络中，只需在本地传送。
  - 如果不同，，则发送主机会将数据包转发到路由器接口（即默认网关），再由路由器转发到目的主机所在的远程网络。

![image-20231211145936095](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211145936095.png)

**物理网络与逻辑网络（本地网络）：**

物理网络是指各主机相互之间有物理连接；各主机通过各种网络设备、介质互连。

在下图所示的物理网络中，有三台主机的IP地址的网络部分同为192.168.18，而另外三台主机的IP地址的网络部分则同为192.168.5，于是**在该物理网络中就存在两个逻辑网络**。**网络部分相同的主机属于同一个逻辑网络**，可直接相互通信；而**网络部分不同的主机则属于不同的逻辑网络**、必须通过“路由器”才能相互通信！

![image-20231211150057805](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211150057805.png)



### 5.2   IP地址的类型

#### 5.2.1   IP地址类和默认子网掩码

- IP地址分为五类。A类、B类和C类是商业类地址，可分配给主机。D类保留供组播使用，而E类则保留用于实验用途。
  - C类地址默认子网掩码为24位（255.255.255.0），通常分配给小型网络（$2^8-2$）。
  - B类地址默认子网掩码为16位（255.255.0.0），一般用于中型网络（$2^{16}-2$）。
  - A类地址默认子网掩码为8位（255.0.0.0），一般分配给大型组织（$2^{24}-2$）。
  - EXP//    B类的全0网络是128.0.\*.\*，全1网络是191.255.\*.\*。C类的全0网络是192.0.0.\*，全1网络是223.255.255.\*，所以192.168.*.*既不是全0、也不是全1网络。**通过首个八位字节的值，就可以确定地址的类别。**

![image-20231211151233851](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211151233851.png)

#### 5.2.2   公有和私有地址

#### 5.2.3   单播、广播和组播地址



## Chap-6 网络服务

### 6.1  客户端/服务器及其交互

#### 6.1.1   客户端和服务器的关系

大多数常用的Internet应用程序都依赖于服务器和客户端之间的交互。服务器和客户端的种类繁多，其交互方式也复杂多样。

服务器安装了特殊的软件程序，它可以为网络上的其它主机提供信息或服务。例如Web服务器就是典型的服务器。

确保Internet上各种服务能够正常进行的关键是：服务器和客户端必须都遵循统一的标准和协议。



**常用网络服务简介**

![image-20231211155939516](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211155939516.png)

![image-20231211155945722](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211155945722.png)

![image-20231211155958259](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211155958259.png)

![image-20231211160036033](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211160036033.png)

![image-20231211160041844](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211160041844.png)

![image-20231211160046981](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211160046981.png)

![image-20231211160051053](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211160051053.png)



#### 6.1.2   协议在客户端服务器通信中的作用

服务器和客户端在交换信息的过程中，使用特定的协议和标准以确保：正确接收和理解交换的报文（消息message）。

这些协议自上而下分别为：应用层协议、传输层协议、网络层协议和网络接入层协议。

- 上：与用户近（处理内容）
- 下：与介质近（传输数据）

四层TCP/IP协议栈模型

![image-20231211160116782](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211160116782.png)

#### 6.1.3   TCP和UDP传输协议

- TCP传输协议（传输控制协议）：先建立连接，再通过确认来可靠地通信。
  - 当应用程序**需要确认报文是否已送达**时，会使用TCP协议。
  - 在发送方主机上，TCP将报文划分为较小片段，称为数据段（Segment），数据段按顺序进行编号并传出。
  - 在接收主机上，TCP协议按顺序号重组报文各个的数据段，然后**发回一个确认**。
  - 如果发送主机在规定时间内未收到接收方的确认，则会认为数据段已丢失，于是将重新传输。**只重传丢失的部分**！
  - FTP和HTTP是使用TCP确保数据传送无误的典型应用实例
- UDP传输协议（用户数据报协议）：没有确认机制，不可靠（高效）通信机制。
  - UDP没有确认和重传机制，是一种**高效率**的传送机制。
  - 与TCP不同，UDP不跟踪数据段的顺序号，仅仅是将接收到的数据段按**先来后到**的顺序传送到其上层的应用程序。
  - UDP是音频流、视频流和IP语音（VoIP）之类应用程序的首选，UDP的典型应用场合是Internet广播。
  - 使用确认机制会降低传送速度。例如传声时，丢失少量数据包时，会有轻微的声音中断。但如果使用TCP，就会重新发送丢失的数据包，这需要暂停传输来接收这些数据包，那么中断反而会更加明显。

**小结：IP与TCP/UDP的关系**

- IP协议负责添加数据包的网络层报头，封装源与目的IP地址，确定路由，根据源与目的IP地址确定传送路径。而TCP和UDP传输协议则负责数据段的传输层报头，指定传输消息的机制与方式。
- TCP是可靠且功能齐全的传输协议，用于确保所有数据到达目的设备。相反，UDP是不提供任何可靠性的一个非常简单、同时也是高效的传输协议。



- IP协议是属于OSI模型第3层网络层的协议
- TCP/UDP协议是属于OSI模型第4层传输层的协议

#### ! 6.1.4/6.2.7   TCP/IP端口号（重要概念）

使用TCP或UDP传送报文时，在数据段内封装了**端口号**。端口号包括：源端口与目的端口，分别用于跟踪特定会话和表明所需服务类型。

- 目的端口：客户端将目的端口号封装在数据段内，以此通知服务器，客户端请求的是何种服务。端口号与服务相对应，两个不同的服务不能用同一端口号，那样会发生端口冲突。
  Web和FTP实验中应特别注意！
- 源端口：源端口号由发送方设备随机生成，用于标识和跟踪两台设备之间的会话。

源端口和目的端口号都被置入**数据段**内，然后数据段封装于数据包内（加上源和目的IP地址），最后数据包又被封装于数据帧内（加上源和目的MAC地址）。

**源IP地址和目的IP地址**以及**源端口号和目的端口号**的组合称为**套接字（socket）**。套接字用于标识客户端及其请求的服务器和服务。

![image-20231211204726488](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211204726488.png)

Internet中的每一项服务都有一个特定的端口号（如Web服务的默认端口为80）。用户主机根据自己所需的服务，将请求发送到相应的端口。

端口号分为三种类别，其范围介于1到65,535之间（数据段中端口号字段为16位，最大为216-1）。

- 公认端口：与通用网络应用程序相关联的目的端口，范围为1到1023。如：HTTP 80、FTP 21等
- 注册端口：1024~49151可作为源端口或目的端口使用。厂商可使用这些端口注册各自的应用程序。  
- 私有端口：49152~65535通常作为源端口使用。任何应用程序均可使用这些端口。

### 6.2   应用程序协议和服务

#### 6.2.1   域名服务（DNS）

- DNS：将域名与IP地址相关联
  - **将域名解析为IP地址**，以便客户端与服务器建立连接。域名本身无法被访问，只有IP地址才能被访问，域名只是便于记忆而已。
  - DNS服务器中包含一张表，通过该表来确立域内的主机名（即域名）与相应的IP地址的关联关系。
  - DNS服务使用53端口。
  - 客户端软件以透明的方式从DNS服务器获取IP地址。透明：用域名访问网站时自动完成解析，用户毫无察觉。

#### 6.2.2   Web客户端和服务器

- Web服务：在Web客户端和服务器之间传输信息的服务。
  - 客户端向服务器发送Web服务请求时，使用的是超文本传输协议（HTTP）。
  - 服务器收到客户端对其端口80（默认值，端口号可修改）的请求后做出响应，向客户端发送网页。
  - http://xxx(默认端口号80可不写)
  - http://xxx:nnn(非80端口号要写)
  - HTTP并非是一种安全的协议。对安全HTTP服务的请求将发送到端口443，此类请求需使用https://开头的网址，多用于网上银行、加密用户服务等场合。
  - HTTPS 协议的安全基础是 SSL（Secure  Socket  Layer，安全套接层）。

#### 6.2.3   FTP客户端和服务器

- FTP服务
  - 用于客户端和服务器之间的**文件上传、下载及远程管理**。
  - 客户端和服务器之间使用两个不同的端口进行通信： 
    - 建立连接及发送控制命令时默认使用21端口。
    - 传输数据时默认使用20端口。
  - 端口号可修改。例如：本课程FTP的端口号为111，这是建立连接以及发送控制命令时的端口号，而传输数据的端口号则可由FTP软件来设置。
  - 计算机操作系统和Web浏览器都内置了FTP客户端软件。

#### 6.2.4   电子邮件客户端和服务器

- Email服务
  - 为用户提供发送、接收和存储邮件的服务。Email服务器上运行的服务器软件可以让Email服务器与客户端、或与其它Email服务器进行交互。
  - 使用“**用户@公司.域**”的格式设定信箱地址。
  - 使用简单邮件传输协议（SMTP）发送邮件，使用邮局协议（POP3）或Internet邮件访问协议（IMAP4）收取邮件。
  - **简单邮件传输协议（SMTP）**：Email客户端使用SMTP向其Email服务器发送邮件；在Email服务器之间传送邮件时，也使用SMTP。SMTP请求将发送到端口25。
  - **邮局协议（POP3）**：使用POP协议的Email服务器负责接收和存储其用户的邮件。当用户连接到Email服务器时，邮件将下载到客户端中。在默认情况下，客户端访问邮件后，服务器将不再保留该邮件。POP3使用端口110。
  - **Internet邮件访问协议（IMAP4）**：使用IMAP协议的Email服务器会接收和存储其用户的邮件。它会将邮件一直保存在信箱中，直至用户主动删除这些邮件。IMAP的最新版本是IMAP4，IMAP4使用端口143。



## Chap-7   无线技术

### 7.1   无线技术

#### 7.1.1   无线技术和设备

公共无线通信波段主要包括：红外（IR）和无线电射频（RF）波段部分。

- **红外线（IR）**的特点：
  - 能量非常低，无法穿透墙壁或其它障碍物。
  - 只支持一对一类型的连接。
  - 常用于连接个人数字助理（PDA）和PC机，并传送数据。
  - 使用专用的通信端口~红外访问端口（IrDA端口）在各种设备之间交换信息。
  - 还常用于遥控设备，如电视等的遥控器、
  - 无线鼠标和无线键盘，但通常只适合视线
  - 范围内的近距离通信。
  - 通过反射IR信号，可以扩大通信距离。
- **无线电射频（RF）**可穿透墙壁及其它障碍物，适用范围比红外线（IR）大得多。
  - RF的某些频段预留给无需许可证的设备使用，如：无线局域网、无绳电话、计算机外围设备等。这些频段包括900MHz、2.4GHz和5GHz频率范围，称为工业科学和医疗波段（ISM）。
  - 蓝牙（Bluetooth）是一种使用2.4GHz频段的RF技术，它仅限于低速、近距离通信，但可以同时与多种设备通信。在连接计算机外围设备（鼠标、键盘和打印机）时，这种一对多的通信能力和IR相比，具有较大优势。
  - 使用2.4GHz和5GHz频段的无线局域网（WLAN）技术，它们符合IEEE 802.11的系列标准。这些技术与蓝牙技术的区别在于：其发射功率更高，故传输距离也更大。我们实验中的重点！

#### 7.1.3   无线网络的类型及其界限

- 无线网络分为三个类别：WPAN、WLAN、WWAN。
  - 虽然存在这些不同类别，但却很难清楚地划分无线网络的界限。因为无线网络与有线网络不同，它没有精确的范围界限。无线网络的覆盖范围取决于多种因素。
  - 无线网络容易受到外部环境的干扰。温度和湿度的变化会极大地改变无线网络的覆盖范围。无线环境中的障碍物也会影响覆盖范围。

![image-20231211152419096](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211152419096.png)

- WPAN的特点
  - 最小类型的无线网络
  - 常用于将各种外围设备连接到计算机，如：无线鼠标、无线键盘或PDA。使用 IR技术或蓝牙技术传输数据。
- WLAN的特点：
  - 用于延伸有线网络（LAN）的覆盖范围。
  - 它使用RF技术。
  - 可以让无线用户通过**接入点设备（AP）**连接到有线网络。AP是一种专用于**将无线主机连接到有线网络**中的设备。
- WWAN的特点：
  - 网络覆盖非常广大的区域。移动电话网络就是一种典型的WWAN。
  - WWAN网络使用：码分多址（CDMA）或者全球移动通信系统（GSM）以及3G、4G、5G、LTE等技术，通常受政府机构的管制。

![image-20231211152636111](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211152636111.png)





### 7.2   无线 LAN

#### 7.2.1  无线LAN标准

IEEE 802.11标准用于管理 WLAN环境。目前可用的各种协议有：802.11a、802.11b、802.11g和802.11n。这些技术标准统称为无线保真（Wireless Fidelity，Wi-Fi）。

#### 7.2.2   无线LAN组件

![image-20231211152802025](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211152802025.png)

- 天线
  - 定向天线：将信号强度集中到一个方向发射。常用于需要远距离无线传输的无线网桥上。
  - 全向天线：朝所有方向均匀发射信号。集成无线路由器、无线AP以及无线网卡上一般都用全向天线。

#### ! 7.2.3   WLAN和SSID

- 服务集标识符 SSID（重要概念！）

  - SSID是一个区分大小写的数字字母字符串，最多可以包含32个字符。它包含在**所有无线帧的报头**中，并通过WLAN以明文方式传输。
  - SSID相当于WLAN的名字（无线网络名称），用于**标识无线设备所属的 WLAN 以及能与其通信的其它设备**。
  - 同一个WLAN中的所有设备，必须使用相同的SSID，相互之间才能成功通信。

- WLAN有两种基本形式：基础架构模式和对等模式。

  - **! 基础架构模式**（Infrastructure）

    - 由**单元中心的AP设备**控制所有通信，确保所有STA（无线客户端）都能平等访问介质。

    - 不同STA之间无法直接通信。

    - 家庭和企业环境中最常用的无线通信模式。

    - 单个AP的覆盖区域称为**基本服务集（BSS）或单元**。

      ![image-20231211153112735](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211153112735.png)

  - 对等模式（Ad Hoc）
    - 在点对点网络中，将两台或以上的终端主机连接到一起，即可创建最简单的网络——对等网络，其中**不含AP**。
    - 所有的终端主机是平等的。
    - 对等模式适用于小型网络。可以在设备之间交换文件和信息。
    - 此网络覆盖的区域称为独立的基本服务集（IBSS）。

![image-20231211153426577](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211153426577.png)

\***扩展服务集（ESS）（简单了解）**

- 基本服务集（BSS）是WLAN最小的构成单位。单个AP的覆盖区域有限。要扩大覆盖区域，可通过分布系统**将多个BSS连接成为ESS**。ESS使用多个AP。每个AP都位于一个独立的BSS中。
  - BSS必须具有大约10%的重叠量，允许客户端在与前一个AP断开之前，先连接到后一个AP，以实现无缝漫游。

![image-20231211153635201](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211153635201.png)

#### 7.2.4   无线通道（Channel）

对RF频谱作进一步划分可形成通道。每个通道都可以传送不同的信号，类似于多个不同的电视频道信号可通过同一个介质传输。

不同的WLAN（BSS）必须使用不同的通道，以避免互相之间干扰。

#### 7.2.5   配置接入点

无线参数：无线模式、SSID、频段（Channel）以及是否允许SSID广播等。

#### 7.2.6   配置无线客户端

**无线客户端（STA）定义**：安装**有无线网卡和无线客户端软件**的任何设备。如PDA、笔记本电脑、台式PC、打印机、投影仪和Wi-Fi电话。

客户端的配置必须与AP或无线路由器的配置匹配，包括：SSID、通道和安全设置等。这些配置可以在无线客户端管理软件上设定。



### 7.3   无线LAN的安全考虑

#### 7.3.1   为什么WLAN会受到攻击

可以采用的安全防范措施包括： 

- 禁用SSID广播功能
- 改变默认设置，例如SSID、密码和IP地址
  - 注意：某些更改无法绝对保护无线网络。例如SSID用明文传输，有些设备可以拦截无线信号，读取明文消息。即使关闭了SSID广播功能，攻击者也可以拦截到无线信号，并得知无线网络的SSID名称，然后用此信息连接到无线网络。
- 配置MAC地址过滤
  - 精确控制哪些设备可以访问无线网络。
  - 这种安全保护方法也存在一些问题：
    - 所有设备在尝试连接到网络之前，必须先将其MAC地址加入过滤列表数据库中，否则将无法连接。
    - MAC地址可以修改（克隆）：例如：网卡属性“网络”选项卡配置“高级”选项卡属性网络地址（或Network  Address） 可修改为其它设备的MAC地址（哄骗spoofing）修改后可用ipconfig/all命令看到效果。

#### 7.3.3   WLAN上的身份验证

控制用户能否连接的另一种方法是实施身份验证。身份验证是根据一组证书（规则），来验证尝试连接网络的设备是否可信。

- 使用用户名和密码是最常见的身份验证形式。

无线身份验证方法有三种：

- Open Authentication（开放式身份验证）
  - 无线设备不要求身份验证，任何客户端只要知道设备的SSID，均可关联，称为开放式身份验证。

![image-20231214173231687](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231214173231687.png)

- PSK（预共享密钥）
  - 使用PSK时，AP和客户端需配置相同的密钥或加密密码。
  - PSK执行单向身份验证，即只向AP验证主机身份。

![image-20231214173238189](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231214173238189.png)

- EAP（可扩展身份验证协议）
  - EAP提供双向的身份验证以及用户身份验证。身份验证转交给后端身份验证服务器（如RADIUS服务器）来进行。

![image-20231214173315457](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231214173315457.png)

如果同时启用了身份验证和MAC地址过滤，则会先进行身份验证，然后再检查MAC地址。



![image-20231214173429302](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231214173429302.png)





#### 7.3.4   WLAN上的加密

经过加密后，攻击者即使拦截了传输的数据，也无法理解和使用它们。

- **WEP（有线等效协议）**是一种防范攻击者拦截数据的高级安全功能，使用预配置的密钥加密和解密通信数据。
  - WEP密钥是一个由数字和英文字母组成的字符串，长度为64或128或256位。
  - 为使WEP生效，必须为AP或无线路由器以及每台无线终端设备都设置输入相同的WEP密钥。若没有此密钥，设备将无法理解无线传输的内容。
  - WEP的缺陷：WEP使用**静态密钥**（密钥固定不变），攻击者可以使用一些应用程序来破解WEP。
- **Wi-Fi保护访问（Wi-Fi Protected Access， WPA）**
  - WPA也使用加密密钥，其长度为64位~256位，每当客户端与AP或无线路由器建立连接时，WPA都会**生成新的动态密钥仅供本次连接使用**。
  - WPA的加密算法本身更强，WPA比WEP更安全，破解难度也更大。

#### 7.3.5   WLAN上的通信过滤

进行通信过滤可以阻止不适当的通信流量传入或传出无线局域网。

- 可删除“来自或发往”某些特定IP地址（或MAC地址）的通信数据。
- 可通过端口号拦截特定应用程序或服务。例如，可阻止发往身份验证服务器的所有Telnet（端口号23）的通信流量，任何想Telnet到身份验证服务器的尝试都被视为可疑通信数据而被拦截。





## Chap-8   交换机和终端设备的配置

计算机需要有操作系统才能工作，这也包括交换机、路由器、接入点和防火墙等网络设备。这些网络设备使用的操作系统称为网络操作系统。

网络操作系统管理网络设备的硬件，使之能正常工作，同时为用户提供交互界面。

### 2.1   IOS访问

#### 2.1.1   操作系统

- 所有终端和网络设备都需要有操作系统（OS）。
- 操作系统中与设备硬件交互的部分称为内核，与用户交互的部分称为外壳。
- 用户可使用命令行界面（CLI）或者图形用户界面（GUI）与外壳交互。

#### 2.1.2   GUI（图形用户界面）

GUI界面，如Windows、Apple IOS或Android，允许用户利用图形图标、菜单和窗口与系统交互。GUI的用户友好性更高，而且用户只需相对较少的相关专业知识即可控制系统。出于这个原因，许多个人用户都依赖于GUI 环境。

#### 2.1.3   CLI（命令行界面）

在CLI中，用户使用键盘输入命令，以文本方式与系统交互。系统执行命令，提供文本输出。    

CLI要求用户具备较高的专业知识水平，但是CLI可用的功能更多，消耗资源更少，而且更稳定。因此，通常通过CLI来访问专业网络设备。Cisco IOS使用CLI。

#### 2.1.4   访问方法

访问 Cisco IOS 最常见的方法有：

- 控制台（Console）：一种专用的管理端口，通过该端口可以对设备进行带外访问（out-of-band，无需IP地址）。使用 RJ45反转线 或 USB电缆。
- 安全外壳（SSH）：一种通过虚拟接口建立远程安全会话的方法。SSH连接需要使用网络，对虚拟接口配置IP地址。SSH不属于带外访问，需要IP地址。
- Telnet：一种通过虚拟接口建立远程不安全会话的方法，也需要IP地址。Telnet不能提供安全的加密连接，用户身份验证、密码和命令通过网络以明文发送。

#### 2.1.5   终端仿真程序

当PC机与网络设备以某种方式建立连接之后（控制台/SSH/Telnet），需要运行某种终端仿真程序以打开CLI，供用户以文本方式对设备进行配置或交互。

PuTTY（支持带外及非带外访问）就是其中之一。

### 2.2   IOS导航

1. 对网络设备进行配置时，首先要在PC机和设备之间建立连接。
2. 在PC机上运行终端仿真程序（如Putty等），打开CLI。
3. 连接登录到设备后，需要在IOS的各种命令模式之间切换。
4. Cisco IOS的命令模式为分层结构，交换机和路由器类似。

![image-20231211210333215](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211210333215.png)

#### 2.2.1   主要命令模式

Cisco IOS 管理系统的两种模式：

- 用户EXEC模式：该模式功能有限，仅可执行某些基本操作。它只允许执行数量有限的监控命令，不允许执行任何改变设备配置的命令。用户 EXEC模式采用 > 提示符。
- 特权EXEC模式：要执行配置命令，必须使用特权模式。某些权限较高的配置模式（全局配置模式），只能通过特权EXEC模式访问。特权EXEC模式采用 # 提示符。

#### 2.2.2   配置模式和子配置模式

- 全局配置模式（需先进入特权模式，才能进入全局配置模式！）
  - 配置设备时，需使用configure terminal命令进入全局配置模式  
  - 标识符：设备名后加（config）#，如 Switch（config）#
  - 在此模式下进行CLI配置，将改变设备的运行状态
  - 在此模式下，还可以进入不同的配置子模式
- 全局配置模式下，包括两个常见的配置子模式：
  - 线路配置模式：用于配置控制台、SSH、Telnet访问。示例：Switch（config-line）# 
  - 接口配置模式：用于配置交换机端口或路由器接口。示例：Switch（config-if）#

#### 2.2.4   在IOS模式之间导航

![image-20231211210528220](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211210528220.png)

### 2.3   命令结构

#### 2.3.1   基本IOS命令结构

IOS命令有特定的格式或语法，且只能在相应的模式下执行。

常规命令的语法为：命令字后接相应的关键字和参数

- 关键字：操作系统中有定义的（如图中的 ip  protocols）
- 参数：没有预定义的值或变量（如图中的 192.168.10.5 ）

输入包括关键字和参数在内的完整命令后，按Enter键提交。

![image-20231211210610756](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231211210610756.png)

### 2.4   设备基本配置

#### 2.4.1   设备名称

#### 2.4.3   配置密码

#### 2.4.4   加密密码

#### 2.4.5   横幅消息

### 2.5   保存配置

#### 2.5.1   配置文件

#### 2.5.2   修改运行配置

### 2.7   配置IP地址

#### 2.7.4   交换机虚拟接口（SVI）配置

### 2.8   验证连接

#### 2.8.1   接口编址验证

#### 2.8.2   端到端连接测试





### EXP	无线网络中DNS和IIS服务器的配置应用实验DNS服务器的安装和配置

#### 一、关于主和辅域名服务器的概念

如果网络中只有一台域名服务器，则当它停机时，用户就无法用它来解析域名了。

为了提高系统的鲁棒性（robustness），可以建立至少两台域名服务器。第二台域名服务器与第一台域名服务器分担负载，或者在第一台服务器停机时处理所有的负载。

- 第一台服务器：主域名服务器
- 第二台服务器等：辅域名服务器

主域名服务器和辅域名服务器最关键的区别是它们**从哪里获得数据。**

- 主域名服务器从**本地数据库文件**中读取数据，而辅域名服务器是**通过网络从其它的域名服务器**获取数据（这个过程称为区域传送）。
- 辅域名服务器并不一定要从主域名服务器获取数据，它还可以从别的域名服务器处获取数据。

#### 二、DNS服务器的配置过程

Windows Server 2019（Win10系统的服务器版本）的DNS服务器有“正向查找区域”和“反向查找区域”。

- 正向查找区域：由域名查询IP地址。
- 反向查找区域：由IP地址查询域名。
- Windows中DNS服务器域名不区分大小写！

#### 三、检验DNS服务配置效果

- 在cmd窗口中，输入“ping www.xxxxxx.com”
- nslookup命令：nslookup   域名
  		                 nslookup   域名   DNS服务器的IP地址

### IIS服务器的安装和配置

building

## Chap-9   基本安全性

### 8.1   网络威胁

#### 8.1.3   社会工程

对于内部和外部入侵者而言，要想获得内部网络的访问权，最简单的一种方法就是：利用人类的弱点，容易轻信别人。

常见方法之一：社会工程（Social Engineering）

社会工程最常用的三种技术分别为：假托、网络钓鱼、语音网络钓鱼。

- 假托（Pretexting）：攻击者对受害人编造虚假情景，以使受害人泄漏信息或执行某种操作，从而使攻击者获得不当利益。
  - 要使假托起作用，攻击者必须能够与攻击目标人员或受害人建立合理联系。攻击者需要预先进行一些了解或研究。
  - 例如，如果攻击者知道攻击目标的社会保险号（美国）或身份证号码（中国），他们就会利用该信息来获取信任，使得攻击目标有可能进一步泄漏信息。

- 网络钓鱼（Phishing）：网络钓鱼者将自己伪装成外部机构的合法人员。他们通常通过电子邮件联系攻击目标。
  - 网络钓鱼者可能会声称，为避免某些糟糕的后果，要求攻击目标提供确认信息（例如密码或用户名）。
- 语音网络钓鱼（Vishing）/电话网络钓鱼（Phone Phishing）是一种使用IP语音（VoIP）的新式社会工程。
  - 用户会收到一封语音邮件，邮件中指示他们拨打一个看上去像是正规电话银行的服务电话号码。随后，不设防的用户拨打该号码时，通话会被窃贼截听。为了进行确认而通过电话输入的银行帐户或密码便被攻击者窃取。

### 8.2   攻击方式

#### 8.2.1   病毒、蠕虫和特洛伊木马

借助于计算机**软件的漏洞**来执行的攻击技术：病毒、蠕虫和特洛伊木马。

所有这些都属于恶意软件。它们会损坏系统、破坏数据以及阻止合法用户对网络、系统或服务进行正常的访问。

它们还可能将数据和个人详细信息从不设防的用户转发到黑客手中。

一般情况下，它们会自身复制，然后传播并感染连接到网络的其它主机。

- **病毒**是通过修改并附加到其它程序或文件上来运行和传播的一种程序。
  - 病毒无法自行启动，需受到激活（人为启动其所附着的程序）。
  - 有的病毒一旦激活，便会迅速自我复制并四处传播，但不会执行其它操作。这类病毒虽然很简单，但仍然非常危险，它们会迅速占用内存和CPU，导致系统崩溃。
  - 一些更为恶毒的病毒可能会删除或破坏特定类型的文件。
  - 病毒可通过电子邮件附件、下载的文件、即时消息或磁盘、光盘或USB设备（如U盘）传播。

- 蠕虫类似于病毒，与病毒不同的是它**无需将自身附加到其它程序或文件中**。蠕虫使用**网络**将自己的副本发送到任何连接的主机中。如冲击波、震荡波、熊猫烧香。
  - 蠕虫可独立运行并迅速传播，它并不需要激活或人类干预即可发作。自我传播的网络蠕虫所造成的影响可能比单个病毒更为严重，而且可迅速造成Internet大面积感染。

- 特洛伊木马**无自我复制能力**，常以合法程序的面貌出现，实质上却是一种攻击工具。
  - 特洛伊木马依赖于其“合法无害”的外表（一个实用工具或一个可爱的游戏）来诱使受害人启动该程序。它的破坏性可能相对较低，但也可能包含可损坏硬盘数据的代码。
  - 特洛伊木马可以对系统创建后门从而使黑客获得访问权。它一般由两部分组成：服务器程序和控制器程序。“中了木马”是指被安装了服务器程序。如果你的电脑被安装了服务器程序，那么拥有控制器程序的黑客就可以通过网络远程控制你的电脑了。

#### 8.2.2   拒绝服务和暴力攻击

- **拒绝服务（DoS）攻击**
  - 针对单个或一组计算机执行的一种侵略性攻击，目的是**使服务器无法为合法用户提供服务**。
  - DoS=Denial of Service
  - 两种常见的DoS攻击为：
    - **SYN（并发）泛洪攻击**：**向服务器发送大量请求数据包**，其中包含**无效的源IP地址**。服务器会因为**试图响应这些虚假请求**而变得极为忙碌，导致无法响应合法请求。
    - **死亡之Ping**：向设备发送超**过IP协议所允许的最大容量（65,535字节）的数据包**。这可导致接收设备**系统崩溃**。
  - 一般DoS攻击的**意图**是：
    - 使用通信量淹没系统或网络，阻止正常网络通信量通行。
    - 中断客户端与服务器之间的连接，以阻止对服务的访问。
- **分布式拒绝服务（DDoS）攻击**
  - DDoS是更为狡猾、更具破坏性、运行**规模更大的DoS攻击**，通常会有成百上千个攻击点同时淹没攻击目标。
  - **攻击点可能是感染了DDoS代码的计算机**（僵尸计算机），它们被“远程控制”并被激活DDoS代码，然后对某个目标站点“群起而攻之”，最终导致其陷入瘫痪。
- **暴力攻击**
  - 攻击者使用运行速度很快的计算机来尝试**猜测密码或破解加密密钥**。攻击者会在短时间内尝试大量可能的密码来试图获取访问权限或破译密钥。
  - 暴力攻击可引起因重试出错次数太多而导致**用户帐户锁定**，使得合法用户被拒绝服务。

#### 8.2.3   间谍软件、跟踪Cookie、广告软件和弹出广告

有些网络威胁的目的是**收集用户信息**以用于广告。尽管它们可能不会损坏计算机，但仍会侵犯隐私，而且其广告内容通常招人反感。

- **间谍软件**是一种程序，用于在**未得到用户认可或用户不知情**的情况下从计算机中**收集个人信息**。然后，这些个人信息会发送至Internet 上的广告商或第三方，其中可能包含密码和帐号等隐私信息。             
  - 间谍软件通常是在下载文件、安装其它程序或点击网页弹出广告时暗中安装的。它会降低计算机速度，更改计算机内部设置，导致暴露更多的系统漏洞。此外，间谍软件通常也是难以删除的（流氓软件）。

以下均为间谍软件类型

- **跟踪Cookie**是间谍软件的一种。
  - Cookie在用户访问网络时会起到一些积极的作用。例如：Cookie可以记录用户的访问信息，允许作个性化定制，为用户登录网站提供便利，所以相当有用并受人欢迎。现在许多网站都要求用户启用浏览器的Cookie功能后才能正常访问。
- **广告软件**是另一种形式的间谍软件，它通过**用户访问的网站**来收集用户信息，这些信息会被利用来作针对性的广告宣传。广告软件一般是作为用户**使用“免费”软件的交换条件**而安装的，会影响网上冲浪的速度，一般也难以卸载。
- **弹出广告**和**背投广告**是用户在浏览网站时显示的附加广告宣传窗口。与广告软件不同，弹出广告和背投广告并不收集关于用户的信息，而且通常只与所访问的网站关联。
  - 弹出广告在当前浏览器窗口前端打开（有焦点）。
  - 背投广告在当前浏览器窗口后端打开（无焦点）。

#### 8.2.4   垃圾邮件

通过Internet大量散发邮件进行营销或其它非法宣传的方法称为垃圾邮件（Spam）。

垃圾邮件是非常严重的网络威胁，可导致ISP、电子邮件服务器和终端用户系统不堪重负。

### 8.3   安全策略

#### \*8.3.1   常用安全措施

用户在使用组织内部的网络和访问信息资源时，必须遵守相关的规则，而安全策略则是对这些规则的正式声明。

安全策略应包含以下内容：（简单了解）

- 标识和身份验证策略
- 密码策略
- 合理使用规定
- 远程访问策略
- 网络维护程序
- 事件处理步骤

#### 8.3.2   更新和补丁

黑客获取主机和网络访问权的最常见方法之一便是利用系统软件的漏洞。

补丁是修复特定问题的一小段代码。

更新则可能包含新的附加功能以及针对特定问题的补丁。

此外，厂商通常还会发布补丁和更新的集合，称为服务包（Service Pack，SP）。

#### 8.3.3   防病毒软件

#### 8.3.4   反垃圾邮件

#### 8.3.5   反间谍软件



### 8.4   使用防火墙

#### 8.4.1   什么是防火墙

- 防火墙是保护**内部网络用户**远离**外部威胁**的安全工具。
  - 防火墙驻留在两个或多个网络之间，**控制其间的通信流量**并**帮助阻止未经授权的访问**。
  - 防火墙使用多种技术来区分应禁止和应允许的网络访问，包括：
    - **数据包过滤**：根据IP地址或MAC地址来阻止或允许访问。
    - **应用程序/网站过滤**：根据应用程序（即对应不同端口号的不同服务）来阻止或允许访问；网站过滤则通过指定要过滤的网站URL地址或关键字来实现。
    - **状态包侦测**（SPI，也叫状态防火墙）：传入数据包必须是对内部主机所发出请求的合法响应才会被允许传入，未经请求的传入数据包会被阻隔。状态包侦测还可识别和过滤特定类型的攻击（如DoS攻击）。
    - 防火墙通常会执行**网络地址转换（NAT）**。NAT**将一个或一组内部私有地址转换为一个公开的外部公有地址**，该地址可通过因特网传送，从而实现**对外部用户隐藏内部IP地址**的目的。

#### 8.4.2   使用防火墙

**非军事区（DMZ）**

在内部网络和Internet之间设置防火墙作为边界设备。通常，外部是看不到内部的。

有外部用户需要访问内部资源，即需要允许外访问内。为此可配置一个**非军事区（DMZ）**。

在计算机网络中，非军事区代表内部和外部用户都可访问的网络区域。其安全性高于外部网络，低于内部网络。

它由一个或多个防火墙创建，这些防火墙起到分隔内部网络、非军事区和外部网络的作用。如用于公开访问的Web服务器通常就位于非军事区中。

**双防火墙配置**

防火墙分为内部防火墙和外部防火墙，其间是非军事区。

外部防火墙限制较少，允许外部用户访问非军事区中的服务，而且允许任何内部用户请求的通信量通过。

内部防火墙则限制较多，用于保护内部网络免遭未经授权的访问。

![image-20231214172242863](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231214172242863.png)

**单防火墙配置**

单个防火墙包含3个区域：外部网络、内部网络和非军事区。

来自外部网络的所有通信流量都被发送到防火墙，防火墙会监控通信流量，并**决定哪些流量应传送到非军事区，哪些应传送到内部网络，哪些应予以拒绝**。

单防火墙配置适用于规模较小、通信量较少的网络。

![image-20231214172334201](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231214172334201.png)





### EXP	虚拟服务器、防火墙等无线网络安全性配置应用实验



## Chap-10	IPv4 编址

### 11.4   网络分段

#### 11.4.1   广播域和分段

路由器的每个接口都连接一个广播域，广播消息只在特定的广播域内传播。广播域等价于LAN。

路由器不转发广播消息。当路由器收到广播消息时，不会将其转发到其他接口。

交换机会将广播消息转发到所有接口，发送广播消息的接口除外。

#### 11.4.2   大型广播域存在的问题

大型广播域的一个问题是：这些主机会生成太多广播，这会对网络造成不良影响。

- 大量广播流量会减缓网络运行速度。
- 主机设备必须接受和处理广播消息，因此也会减缓设备运行速度。

解决方案：通过**子网划分**降低网络规模，使得广播域变得更小。

#### 11.4.3   划分子网的原因及依据

子网划分可以降低整体网络流量并改善网络性能。能让网络管理员实施安全策略，例如：哪些子网允许或不允许进行通信。

网络管理员可以按下列依据进行子网划分：

- 物理位置，如每层楼为一个子网
- 组织部门，如人力资源部为一个子网
- 设备类型，如所有服务器为一个子网

### 11.5   IPv4网络的子网&11.6   使用/16和/8前缀划分子网&11.7   按照要求划分子网

#### 有类子网划分

创建IPv4子网的具体做法：**延长子网掩码**，即从地址的主机部分借用若干位来**增加网络位**（网络部分）。借用的主机位越多，可以定义的子网也就越多。

使用有类地址的前缀/8、/16和/24最容易进行子网划分。下图列出了/8、/16、/24前缀长度相应的子网掩码、网络位和主机位、每个子网可以连接的主机数量。

![image-20231221164348365](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231221164348365.png)



**EXP**

假设某企业选择了私有地址10.0.0.0/8作为其内部网络地址。该网络可以在一个广播域（网段）中连接16,777,214台主机。

但是这并不理想！因为IP地址用不完，严重浪费IP地址资源！

以A类地址为例，在一个A类地址的网络中可以有16,777,214台主机。这些主机属于同一个网络，属于同一个广播域。

但是考虑到实际网络传输介质的性能，一个本地网络/网段的物理范围是有限的，比如一般以太网的范围为100m。

虽然在逻辑上允许这么多主机在同一网络中存在，但物理上该网络范围又容纳不下这么多主机，必然造成有大量的IP地址被浪费。

所谓子网划分，就是使得每个较小的子网内，所有的IP地址都能得到充分的利用！

此企业可以使用前缀/16对10.0.0.0/8的地址进行子网划分，具体做法是借用8位主机位来增加网络位到16位。这能定义多达256个子网（10.0.0.0/16~10.255.0.0/16），每个子网可连接65,534个主机，其实仍多，可继续划分子网。

![image-20231221164821045](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231221164821045.png)

#### 无类子网划分

子网划分可以从任何主机位借位来创建其它结果的子网掩码。

/24网络地址可以从第四个数借位来产生更长前缀的子网掩码。

- /25：借 1 位可创建 2 个子网，每个子网支持 126 台主机。
- /26：借 2 位可创建 4 个子网，每个子网支持 62 台主机。
- /27：借 3 位可创建 8 个子网，每个子网支持 30 台主机。

![image-20231221165028069](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231221165028069.png)

**EXP**

示例：对 192.168.1.0/24 划分子网

![image-20231221165103757](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231221165103757.png)

- Net0网络地址：192.168.1.0
- Net0广播地址：192.168.1.127
- Net1网络地址：192.168.1.128
- Net0广播地址：192.168.1.255

注意不能借7位或8位，否则没有可用的主机地址。有两个地址无法分配给主机，分别是网络地址和广播地址。

子网划分后的网络地址，通常也称为子网地址。

**常见换算**

- 00 000000 = 0
- 01 000000 = 64
- 10 000000 = 128
- 11 000000 = 192

### 11.8   VLSM

#### 传统子网划分浪费地址

传统子网划分可以创建大小相等的子网，每个子网都使用相同的子网掩码。

如果所有子网的主机数量大致相同，这些固定大小的地址块效率就会很高。但大多数情况并非如此，产生了大量未使用的地址，造成地址浪费。

#### 可变长子网掩码

使用可变长子网掩码（VLSM）可细分子网，避免地址浪费，子网掩码**将根据所需借用的位数而变化**。

VLSM子网划分与传统子网划分类似，通过借用位来创建子网。用于计算每个子网主机数量和所创建子网数量的公式仍然适用。

区别在于：VLSM不是一次完成。

使用VLSM时，首先对网络划分子网，然后对子网进行再划分。该过程可以多次重复，以创建不同大小的子网。

注意：当使用VLSM时，需从最大的子网开始，一直划分至最小的子网。

![image-20231221170716046](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231221170716046.png)

VLSM方案将某些子网的地址数目减少到适合WAN连接的大小。在满足目前主机的需求下产生出冗余的子网，可用于未来的网络拓展。

![image-20231221173322445](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231221173322445.png)

#### VLSM图表

注意：Bldg A = Building A（建筑A）

![image-20231221170951270](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231221170951270.png)

编址图用于记录可用的地址块和已分配的地址块，有助于防止重复分配地址。

#### ！！“Magic Number” Method

魔数是一种解决子网划分相关计算的实用高效方法

**EXP**

IP地址：192.168.50.0/27

- 27是子网掩码中为“1”的位数。192开头说明此为C类地址，故在子网划分时从主机位借了3位，主机位还剩5位。
- 其相应的子网掩码即为：255.255.255.224
- Magic Number（魔数）就是：256 - 224 = 32 = 2^5

根据魔数，就能快速计算由192.168.50.0/24借3位可划分得到的第二个子网地址是：192.168.50.32/27

依此类推，接下来的各个子网地址均为魔数32的倍数，即：192.168.50.64/27、192.168.50.96/27、192.168.50.128/27等

**EXP**

![image-20231221173353099](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231221173353099.png)

## Chap-11	网络寻址

### 5.3   获取IP地址的方式

#### 5.3.1   静态和动态地址分配

采用静态方式分配时，网络管理员必须手工配置主机的网络信息。这些信息至少包括主机IP地址、子网掩码和默认网关。

静态地址具有一些优点。例如对于用户要经常访问的网络打印机和服务器等，静态IP地址就很实用，因为这些地址不宜变更。

静态分配地址信息可以提高对网络资源的控制能力，但是在每台主机上输入信息却非常耗时。静态输入IP地址时，系统只对IP地址执行基本错误检查（是否0~255）。发生冲突或不能使用的可能性较大。

使用静态IP寻址时，必须维护一份准确的地址清单，列出设备及为其分配的IP地址。另外，这些地址是固定地址，不能重复使用，要防止发生IP地址冲突影响正常通信。

![image-20231221172605147](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231221172605147.png)

在本地网络中，用户数量通常会频繁变化。例如：新来的笔记本用户也需要连接，需要IP地址。

自动（动态）分配IP地址在方便性方面，优于分配静态IP地址的做法。

要完成自动分配，需使用**动态主机配置协议（DHCP）**。

- DHCP是一种提供自动分配IP地址、子网掩码、默认网关等地址信息和其它配置信息的机制。

在大型网络中，DHCP是分配IP地址的首选方法，因为它可降低网络维护人员的工作负担，而且几乎可以杜绝任何输入错误。

DHCP的另一优点是，地址并非固定分配给某台主机而只是租用一段时间。若主机关闭或离开网络，该地址就会返回地址池（可分配的地址范围），供其他新来的用户再次使用。此特点特别有助于在网络中进进出出的移动用户。

![image-20231221172753347](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231221172753347.png)

#### 5.3.2   DHCP服务器

许多小型网络使用集成路由器通过ISP连接到Internet。这时，集成路由器既是DHCP客户端又是DHCP服务器。

- 集成路由器扮演**客户端**的角色，从ISP处获取公有IP地址配置给其WAN口；
- 集成路由器在本地网络中又作为**内部主机的DHCP服务器**，为它们提供私有IP地址（其LAN口也是私有IP地址）。

#### 5.3.3   配置DHCP

当主机被配置为DHCP客户端时，需要从位于本地网络中或者ISP处的DHCP服务器获取IP地址、子网掩码及默认网关等信息。

DHCP服务器配置有一个IP地址范围（或称为**IP地址池**），这些地址可用来分配给DHCP客户端。

1. 需要IP地址的用户发送DHCP发现报文（message），这是一种广播报文。网络中的所有主机都会收到，但只有DHCP服务器才会作出应答。
2. 服务器使用DHCP提供报文作为响应，为该客户端提供IP地址建议。
3. 然后用户主机向该服务器发送DHCP请求报文，要求使用建议的IP地址。
4. 服务器用DHCP确认报文响应。

![image-20231221173540398](C:\Users\89620\AppData\Roaming\Typora\typora-user-images\image-20231221173540398.png)
